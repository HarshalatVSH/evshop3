// Replaces named or numbered tokens in a string like you'd expect
const formatMessage = (str, ...args) => {
  let values = args.slice();

  // Unwrap any nested arrays that get passed in
  while (values instanceof Array && values.length === 1) {
    values = values.pop();
  }

  // If we were passed a primitive, wrap it in a format that the reduce function will accept
  if (typeof values !== 'object') {
    values = [values];
  }

  return Object.keys(values).reduce((message, key) => (
    message.replace(new RegExp(`\\{${key}\\}`, 'g'), values[key])
  ), (str || ''));
};

export default formatMessage;
